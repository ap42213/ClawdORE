version: "2"

build:
  builder: NIXPACKS
  nixpacksPlan:
    phases:
      setup:
        nixPkgs:
          - rustup
          - gcc
          - openssl
          - pkg-config
        cmds:
          - rustup default 1.85.0
          - rustup target add x86_64-unknown-linux-gnu
      build:
        cmds:
          - cargo build --release --bin simulation-bot

deploy:
  startCommand: ./target/release/simulation-bot
  restartPolicyType: ON_FAILURE
  restartPolicyMaxRetries: 10
